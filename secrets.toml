import ee
import streamlit as st
from google.oauth2 import service_account

# Retrieve the secret from Streamlit Cloud
service_account_json = st.secrets["GCP_SERVICE_ACCOUNT_JSON"]

# Convert the AttrDict to a regular dictionary (needed for from_service_account_info)
service_account_dict = dict(service_account_json)

# Create credentials using the service account (no need to manually convert to JSON string)
credentials = service_account.Credentials.from_service_account_info(service_account_dict)

# Initialize Earth Engine with the credentials
ee.Initialize(credentials)

# Display a success message
st.write("Earth Engine API initialized successfully!")
