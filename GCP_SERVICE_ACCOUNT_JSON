import ee
import json
import streamlit as st
from google.oauth2 import service_account

# Retrieve the secret from Streamlit Cloud
service_account_json = st.secrets["GCP_SERVICE_ACCOUNT_JSON"]

# Convert the AttrDict to a JSON string
service_account_json_str = json.dumps(service_account_json)

# Parse the JSON string and create credentials
credentials = service_account.Credentials.from_service_account_info(
    json.loads(service_account_json_str)
)

# Initialize Earth Engine
ee.Initialize(credentials)

st.write("Earth Engine API initialized!")
